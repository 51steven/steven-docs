Hash 表算法及相关面试题
===================================
# 一、Hash 算法原理
Hash（散列、哈希）是把任意长度的输入通过散列算法变换成固定长度的输出（散列值）。是一种将任意长度的消息压缩到某一固定长度的消息摘要的函数。

hash 方法的主要思想是根据节点的 key 值来确定其存储地址：通过 hash(K) 计算对应的 hash 值，并以这个 hash 值为节点的存储地址将节点存入 hash 表中；若发生 hash 碰撞（两个不同 key 的 Hash 值相同），则在对应 Hash 键下以链表形式存储。检索时，用同样的方法计算地址，然后到相应的 hash 表中获取相应地址的节点数据。

hash 冲突（hash 碰撞）：不同的 key 通过 hash(key) 计算出的 hash 值相同。

## hash 函数
hash 函数的选取原则是：
- 运算尽可能简单；
- 函数的值域必须在散列表的范围内；
- 尽可能使得节点均匀分布（尽量让不同的关键码具有不同的散列函数值）。

需要考虑的因素：
- key 的长度
- hash 表大小
- key 的分布情况
- 记录的检索频率等。

### 常用 hash 函数
- **直接寻址法**：取 key 或 key 的某个线性函数值为散列地址。即H(key)=key或H(key) = a·key + b（其中a和b为常数）。

- **除余法**：h(x) ＝ x mod M，M 通常为 hash 表的长度。

- **乘余取整法**：首先，key*常数A（0<A<1），取乘积的小数部分；然后用整数n乘以这个值，对结果向下取整，并将这个值作为 hash 地址。hash ( key ) = _LOW( n × ( A × key % 1 ) )。

- **平方取中法**：先进行 key 的平方值（扩大相近数的差距），然后取根据表长度取中间几位数作为 hash 值。

- **数字分析法**：当 key 的位数很多时，可以通过对 key 的各位进行分析，丢掉分布不均匀的位，作为哈希值。

- **折叠法**：将 key 分割成位数相同的几部分（最后一部分的位数可不同），然后取这几部分的叠加和（舍去进位）作为 hash 地址。
  - 移位叠加：将分割后的几部分低位对齐相加。
  - 边界叠加:从一端沿分割界来回折叠，然后对齐相加。

*由于整数相除的运行速度通常比相乘要慢，所以尽可能选乘法的算法。*

### 冲突解决的策略
尽管散列函数的目标是使得冲突最少，但实际上冲突是无法避免的。

冲突解决技术可以分为两类：
- 开散列方法(open hashing，也称拉链法) ：把发生冲突的关键码存储在散列表主表之外。
- 闭散列方法(closed hashing，也称开地址方法)：把发生冲突的关键码存储在表中另一个槽内。

# 二、hash 表算法处理海量数据处理面试题
主要针对遇到的海量数据处理问题进行分析，参考互联网上的面试题及相关处理方法，归纳为三种问题：
- 数据量大，内存小情况处理方式（分而治之 + Hash 映射）
- 判断元素是否在集合中（布隆过滤器 + BitMap）
- 各种 TOPN（存储和各种排序）

# 三、面试题具体分析：分而治之+Hash
面试中当给定了**大数据量**和**内存限制**解决方案：
- 1.分而治之 
- 2.利用 Hash 处理文件，大文件拆分为小文件
- 3.对结果合并汇总


# 参考：
- [hash算法原理详解](https://www.jianshu.com/p/f9239c9377c5)
- [（面试）Hash表算法十道海量数据处理面试题](https://www.cnblogs.com/jackchen-Net/p/8111817.html#_label3)
